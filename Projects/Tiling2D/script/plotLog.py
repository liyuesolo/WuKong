import matplotlib.pyplot as plt
import numpy as np

log_file = "/home/yueli/Documents/ETH/WuKong/build/Projects/Tiling2D/lbfgsb_log_correct_test3.txt"

def plotOpt():
    iterations = []
    residual_norms = []
    energy = []

    solver = "L-BFGS-B"
    for line in open(log_file).readlines():
        if solver == "MMA":
            if "[" + solver +"]" in line.strip() and "\t" not in line:
                iteration = line.split("|g|")[0].split("iter ")[-1]
                residual_norm = line.split("|g|: ")[-1].split(" obj")[0]
                obj = line.split("obj: ")[-1].split(" obj0")[0]
                iterations.append(int(iteration))
                residual_norms.append(float(residual_norm))
                energy.append(float(obj))
        elif solver == "L-BFGS-B":
            if "[" + solver +"]" in line.strip() and "\t" not in line:
                iteration = line.split("|g|")[0].split("iter ")[-1]
                residual_norm = line.split("|g|: ")[-1].split(" obj")[0]
                obj = line.split("obj: ")[-1]
                iterations.append(int(iteration))
                residual_norms.append(float(residual_norm))
                energy.append(float(obj))

    iterations = np.array(iterations)
    residual_norms = np.array(residual_norms)
    energy = np.array(energy)
    fig, axs = plt.subplots(1, 2)
    fig.suptitle(solver + 'log')
    axs[0].plot(iterations, residual_norms)
    axs[0].set_title('residual norm')
    axs[1].plot(iterations, energy, linewidth=3.0)
    axs[1].set_title('energy')
    fig.set_size_inches(14, 10)
    plt.savefig(solver + "_log.png", dpi=300)
    print("min |g|: {}, min obj: {}".format(np.min(residual_norms), np.min(energy)))

def plot():
    energy = np.array([0.00101110446371, 0.00101102901677, 0.00101157370261, 0.00101106997025, 0.00101140665416, 0.00101150635139, 0.00101191660747, 0.00101195569162, 0.00101233714285, 0.00101215572771, 0.00101265466741, 0.00101241985186, 0.00101257399116, 0.00101235269946, 0.00101286613834, 0.00101282926075, 0.0010130691079, 0.00101309137542, 0.00101336122255, 0.00101343673048, 0.00101340385496, 0.00101376630657, 0.00101349247351, 0.00101374714003, 0.00101404086682, 0.00101395149222, 0.0010138887154, 0.00101436101694, 0.00101414980305, 0.00101430049084, 0.00101440218298, 0.00101441454293, 0.00101458320475, 0.0010147920568, 0.00101484320794, 0.00101483864748, 0.00101493795216, 0.00101507729952, 0.0010149223464, 0.00101518494944, 0.0010154868631, 0.00101554988303, 0.00101538205187, 0.00101563621879, 0.00101558398482, 0.00101573612074, 0.00101588379565, 0.00101610523643, 0.00101602904453, 0.00101615295528, 0.0010163212128, 0.00101622703173, 0.00101629617706, 0.00101687813922, 0.00101663843247, 0.00101670046663, 0.00101674156641, 0.00101708938475, 0.00101685141015, 0.00101689427159, 0.00101706870652, 0.00101718190161, 0.00101758528709, 0.00101721959716, 0.00101747585987, 0.00101775596739, 0.00101752645855, 0.00101775185277, 0.00101770929107, 0.0010178607452, 0.00101841009662, 0.00101804089597, 0.00101846528772, 0.00101831378717, 0.00101850739276, 0.00101850529881, 0.00101870483502, 0.00101859176627, 0.00101875177981, 0.00101904125366, 0.00101898977948, 0.00101926577763, 0.00101947670109, 0.00101931618458, 0.00101960467368, 0.00101944546586, 0.00101955209459, 0.00101988896696, 0.00101987500165, 0.00102000437404, 0.00102004089574, 0.00101983706643, 0.00102036957301, 0.00102014174298, 0.00102043554396, 0.00102057435524, 0.00102066564641, 0.00102047361906, 0.00102051633969, 0.00102073807253, 0.00102094414439, 0.00102122031141, 0.00102108558603, 0.00102126839216, 0.00102103936962, 0.00102156700584, 0.00102137402025, 0.00102157331505, 0.00102178456758, 0.00102181702857, 0.00102184697191, 0.00102190895013, 0.00102203209818, 0.00102240901811, 0.00102211154793, 0.00102257590285, 0.00102234141338, 0.00102260364594, 0.00102259118411, 0.00102285960372, 0.00102255062796, 0.00102296146604, 0.00102292746279, 0.00102288495836, 0.00102320577649, 0.0010231276364, 0.00102320385567, 0.00102316560142, 0.00102330127933, 0.00102339867973, 0.00102367558055, 0.00102369627035, 0.00102395125065, 0.00102393470221, 0.00102402062031, 0.00102426874832, 0.00102418054666, 0.00102417286539, 0.00102422281611, 0.0010243916291, 0.00102419044568, 0.00102459682719, 0.00102499613198, 0.00102479146001, 0.00102519373374, 0.00102489112904, 0.00102507848605, 0.00102506808558, 0.00102518562304, 0.00102536843945, 0.00102587165001, 0.0010253950965, 0.00102578183526, 0.00102579111416, 0.0010257875718, 0.00102579302014, 0.00102562842076, 0.00102602698685, 0.00102638077598, 0.00102619974589, 0.00102613616892, 0.00102642632465, 0.00102670968391, 0.00102651467066, 0.0010264996295, 0.0010264940674, 0.00102693428204, 0.00102690757896, 0.00102692885628, 0.00102704527409, 0.00102743763194, 0.00102742282995, 0.0010273010087, 0.00102754022866, 0.00102775874037, 0.00102785263868, 0.0010276557922, 0.00102798920144, 0.00102797432362, 0.00102802941808, 0.00102809751367, 0.00102813982643, 0.00102821899725, 0.00102838487102, 0.00102834497723, 0.00102879693886, 0.00102870834554, 0.00102886105712, 0.00102881724174, 0.00102896424476, 0.00102890227135, 0.00102907271916, 0.00102922121007, 0.00102939687796, 0.00102949055978, 0.00102952598205, 0.00102961936559, 0.00102958348276, 0.00102956144585, 0.00102990919653, 0.00102985140023])
    # energy_nn = np.array([0.0011848467374606236, 0.0011852321749767619, 0.0011856178253991858, 0.001186002033006042, 0.0011863877229385965, 0.0011867729153939737, 0.0011871584451837959, 0.001187543172047856, 0.0011879275564879456, 0.0011883128242183357, 0.0011886980584119879, 0.0011890824956183638, 0.0011894678266507132, 0.0011898533773143814, 0.0011902375079553026, 0.0011906220711595035, 0.0011910081859389902, 0.0011913928815383132, 0.0011917776060216218, 0.001192163651565505, 0.0011925459838908572, 0.001192931688933777, 0.0011933177421718602, 0.0011937028038692399, 0.0011940864404778812, 0.0011944720211113393, 0.0011948568896669603, 0.0011952403862897202, 0.0011956261493674912, 0.0011960094792780988, 0.0011963942414671318, 0.0011967788195701339, 0.001197163849717716, 0.0011975495783716247, 0.0011979314854015212, 0.0011983175191947475, 0.0011987014142283046, 0.001199085911231905, 0.0011994714282160589, 0.0011998567382656671, 0.0012002389637281417, 0.0012006232494733997, 0.00120100805951717, 0.0012013914701063534, 0.0012017771111333519, 0.0012021621878546857, 0.0012025464400007542, 0.001202928930607135, 0.0012033135978499476, 0.0012036986373004572, 0.0012040808653238694, 0.0012044647099354732, 0.001204849892682335, 0.001205235634435387, 0.0012056174802890494, 0.0012060023765275193, 0.0012063867943490371, 0.0012067716542551168, 0.0012071541860802287, 0.0012075392707178133, 0.0012079227691459394, 0.001208306320138709, 0.001208688952380118, 0.0012090744628039706, 0.0012094575994249755, 0.001209841379747337, 0.0012102234785350192, 0.0012106093515743825, 0.0012109936329518392, 0.0012113771232045187, 0.001211760327966788, 0.001212144596540812, 0.0012125285541630432, 0.0012129122880459925, 0.0012132962360616958, 0.0012136788594019872, 0.0012140622862661487, 0.0012144455218821015, 0.001214827845433624, 0.0012152125337390384, 0.0012155961080531899, 0.0012159793956734233, 0.001216362964319917, 0.0012167465806224836, 0.001217130028347694, 0.0012175120396074146, 0.0012178964888342222, 0.0012182800248405614, 0.0012186624012390033, 0.001219045552278746, 0.0012194288289386769, 0.0012198148383029015, 0.0012201966458355196, 0.0012205780015498782, 0.001220962464135247, 0.0012213448976190616, 0.0012217299166712814, 0.0012221115879026449, 0.0012224938495319386, 0.0012228772610875917, 0.001223260713650086, 0.0012236438327778156, 0.001224025752614931, 0.001224410283339276, 0.001224793381263034, 0.0012251750080584788, 0.001225557855536578, 0.0012259411496049026, 0.0012277031602994284, 0.0012267055213097844, 0.0012270890870870058, 0.0012274725019628364, 0.0012278542597616892, 0.00122823637987461, 0.001228619826549963, 0.0012290026375421446, 0.0012293838891370876, 0.0012297688538383486, 0.0012301498524434633, 0.00123053265154167, 0.001230914174099893, 0.001231297808538659, 0.0012316803913223961, 0.0012320606986725912, 0.0012324444379925126, 0.0012328268283658943, 0.0012332100348180239, 0.001233592393133834, 0.0012339730956632633, 0.0012343552300343133, 0.0012347377011879806, 0.001235119602179361, 0.001235502311272538, 0.0012358842478112514, 0.001236266621853666, 0.0012366488987121563, 0.001237030113092981, 0.0012374126637851237, 0.0012377948891077572, 0.001238175978137027, 0.001238557633927847, 0.0012389414926408616, 0.0012393218267531645, 0.0012397053659958025, 0.0012400865488462276, 0.00124046836418884, 0.0012408492023692427, 0.0012412303924508336, 0.0012416129260592941, 0.0012419950404784776, 0.0012423769951288668, 0.0012427574117093467, 0.0012431394215601727, 0.0012435203283348508, 0.0012439025476404094, 0.0012442831510015902, 0.0012446648171115199, 0.0012450471463314, 0.0012454271639071855, 0.0012458091845904894, 0.0012461911169493393, 0.0012465719020622673, 0.0012469541687153223, 0.001247336261686526, 0.0012477176569300737, 0.0012480978339423745, 0.0012484805498523782, 0.0012488606447942203, 0.0012492411958760759, 0.0012496231484301688, 0.001250003674598998, 0.0012503839549931025, 0.0012507666634535405, 0.0012511481447311803, 0.0012515288524208375, 0.0012519089254541943, 0.0012522902574723376, 0.0012526705766987127, 0.0012530517162279977, 0.0012534330811777297, 0.0012556097975325448, 0.00125419448144873, 0.0012545749154827875, 0.001254955323142796, 0.001255336889503511, 0.0012557156686915615, 0.0012560990513040954, 0.001256476614936455, 0.0012568593660397694, 0.0012572391781428636, 0.0012576197205888696, 0.0012580013256495537, 0.0012583802878769702, 0.0012587604751502837, 0.0012591409850831736, 0.0012595218254146296, 0.0012599014532757079, 0.0012602818654892328, 0.001260662998824749, 0.0012610435445965377])
    energy_nn = np.array([0.0010693170807516664, 0.001069681536667429, 0.0010700461954492103, 0.0010704094909055634, 0.0010707742001107223, 0.0010711384368712908, 0.001071502988635491, 0.001071866803476474, 0.0010722302900738364, 0.001072594604162425, 0.0010729589046716706, 0.001073322444144866, 0.0010736868333176622, 0.0010740514455983296, 0.0010744147152425758, 0.0010747783879808625, 0.0010751435384212717, 0.0010755073411736007, 0.00107587118993924, 0.0010762362763441088, 0.001076597869001873, 0.00107696265334225, 0.001077327756331931, 0.0010776919347628344, 0.0010780547708191097, 0.0010784194382091462, 0.0010787834474640797, 0.0010791461554821714, 0.001079511019862694, 0.0010798735832221794, 0.0010802375024701796, 0.0010806012541714478, 0.001080965429334091, 0.001081330273022982, 0.001081691505946225, 0.0010820566526186966, 0.0010824197678221178, 0.0010827834522671863, 0.0010831481268285253, 0.0010835125938042822, 0.0010838741498169794, 0.001084237660046437, 0.0010846016719762489, 0.0010849643468565614, 0.00108532915029755, 0.0010856934165678488, 0.0010860569001072222, 0.0010864187388506415, 0.0010867826414335735, 0.0010871468727570847, 0.001087508480255874, 0.0010878716092473958, 0.0010882360007491102, 0.001088600914781038, 0.0010889621615242174, 0.0010893262984643516, 0.0010896899881476523, 0.0010900540932050923, 0.001090416003537819, 0.0010907803246345393, 0.0010911431545548255, 0.0010915060353409178, 0.0010918680529496772, 0.0010922327961381487, 0.001092595300373109, 0.0010929584102986475, 0.0010933199410210145, 0.0010936850358246291, 0.001094048635175421, 0.001094411482706897, 0.0010947740674383494, 0.0010951376687847484, 0.0010955009746532695, 0.0010958640645802025, 0.001096227368327142, 0.0010965894207976032, 0.0010969522423882692, 0.0010973148872953466, 0.001097676668076094, 0.0010980406894978481, 0.0010984036606096744, 0.001098766351820903, 0.0010991293265214957, 0.0010994923434476476, 0.0010998552108771752, 0.0011002167144222358, 0.0011005805303145283, 0.0011009434853673308, 0.0011013053600690981, 0.00110166794478122, 0.001102030673263133, 0.0011023959902161644, 0.0011027573335298925, 0.0011031182416690994, 0.0011034821059292532, 0.001103844042736811, 0.001104208426680188, 0.00110456966516156, 0.0011049314576389508, 0.0011052943416851716, 0.0011056572605091012, 0.0011060198722451348, 0.0011063813523462267, 0.0011067452954372288, 0.001107107898895252, 0.0011074691057937182, 0.0011078314913676043, 0.0011081942770478064, 0.0011098496904199601, 0.0011089177856000016, 0.0011092808493223874, 0.0011096437734579225, 0.0011100051296966838, 0.0011103668401759778, 0.0011107298047277694, 0.0011110921638787152, 0.0011114530586821849, 0.0011118174605116605, 0.0011121781300230632, 0.0011125404991757818, 0.001112901670271445, 0.0011132648258563066, 0.0011136270079736494, 0.0011139870335285418, 0.0011143503060841616, 0.0011147123011461604, 0.0011150750838649006, 0.0011154370593329855, 0.0011157974803900758, 0.0011161592457483603, 0.001116521339480837, 0.001116882897198144, 0.0011172452335789413, 0.001117606826955682, 0.0011179688413603896, 0.0011183307785944709, 0.0011186916966516864, 0.0011190538876763292, 0.001119415779809725, 0.0011197765976467342, 0.0011201379514748382, 0.0011205013919437182, 0.001120861500219838, 0.0011212246575512956, 0.0011215855715516598, 0.0011219471028399112, 0.0011223077078635162, 0.0011226686422256328, 0.001123030856205103, 0.0011233926754077802, 0.0011237543416843646, 0.00112411456597271, 0.0011244762947638241, 0.0011248369859032355, 0.001125198913510843, 0.0011255593307763784, 0.0011259207498303943, 0.0011262827987891808, 0.0011266426617538173, 0.0011270044366225535, 0.0011273661106747984, 0.0011277267097272664, 0.001128088722075305, 0.0011284505583212356, 0.0011288117505949494, 0.0011291717869939674, 0.0011295342428295834, 0.0011298942039435172, 0.0011302546096002655, 0.0011306163437483482, 0.0011309767229901963, 0.0011313368756512814, 0.0011316993390903661, 0.0011320606319968486, 0.001132421204850257, 0.0011327811743899667, 0.0011331423430079482, 0.0011335025580490618, 0.001133863545111009, 0.0011342247608085942, 0.0011362722238995211, 0.0011349459184759518, 0.0011353062547190345, 0.0011356665693312308, 0.0011360279876260638, 0.0011363867708001146, 0.0011367499107491034, 0.0011371075474582986, 0.001137470092624357, 0.0011378298679816069, 0.0011381903289378352, 0.0011385518052676603, 0.001138910771252884, 0.0011392709096490314, 0.0011396313680015566, 0.0011399921245924191, 0.0011403517381985114, 0.001140712102869858, 0.001141073160381954, 0.0011414336487977578])


    step = np.array([-0.01, -0.0099, -0.0098, -0.0097, -0.0096, -0.0095, -0.0094, -0.0093, -0.0092, -0.0091, -0.009, -0.0089, -0.0088, -0.0087, -0.0086, -0.0085, -0.0084, -0.0083, -0.0082, -0.0081, -0.008, -0.0079, -0.0078, -0.0077, -0.0076, -0.0075, -0.0074, -0.0073, -0.0072, -0.0071, -0.007, -0.0069, -0.0068, -0.0067, -0.0066, -0.0065, -0.0064, -0.0063, -0.0062, -0.0061, -0.006, -0.0059, -0.0058, -0.0057, -0.0056, -0.0055, -0.0054, -0.0053, -0.0052, -0.0051, -0.005, -0.0049, -0.0048, -0.0047, -0.0046, -0.0045, -0.0044, -0.0043, -0.0042, -0.0041, -0.004, -0.0039, -0.0038, -0.0037, -0.0036, -0.0035, -0.0034, -0.0033, -0.0032, -0.0031, -0.003, -0.0029, -0.0028, -0.0027, -0.0026, -0.0025, -0.0024, -0.0023, -0.0022, -0.0021, -0.002, -0.0019, -0.0018, -0.0017, -0.0016, -0.0015, -0.0014, -0.0013, -0.0012, -0.0011, -0.001, -0.0009, -0.0008, -0.0007, -0.0006, -0.0005, -0.0004, -0.0003, -0.0002, -0.0001, -5.44811591674e-18, 0.0001, 0.0002, 0.0003, 0.0004, 0.0005, 0.0006, 0.0007, 0.0008, 0.0009, 0.001, 0.0011, 0.0012, 0.0013, 0.0014, 0.0015, 0.0016, 0.0017, 0.0018, 0.0019, 0.002, 0.0021, 0.0022, 0.0023, 0.0024, 0.0025, 0.0026, 0.0027, 0.0028, 0.0029, 0.003, 0.0031, 0.0032, 0.0033, 0.0034, 0.0035, 0.0036, 0.0037, 0.0038, 0.0039, 0.004, 0.0041, 0.0042, 0.0043, 0.0044, 0.0045, 0.0046, 0.0047, 0.0048, 0.0049, 0.005, 0.0051, 0.0052, 0.0053, 0.0054, 0.0055, 0.0056, 0.0057, 0.0058, 0.0059, 0.006, 0.0061, 0.0062, 0.0063, 0.0064, 0.0065, 0.0066, 0.0067, 0.0068, 0.0069, 0.007, 0.0071, 0.0072, 0.0073, 0.0074, 0.0075, 0.0076, 0.0077, 0.0078, 0.0079, 0.008, 0.0081, 0.0082, 0.0083, 0.0084, 0.0085, 0.0086, 0.0087, 0.0088, 0.0089, 0.009, 0.0091, 0.0092, 0.0093, 0.0094, 0.0095, 0.0096, 0.0097, 0.0098, 0.0099, 0.01])
    # plt.plot(step[:-1], energy[:-1], linewidth=3.0, label="energy_SIM")
    plt.plot(step[:-1], energy_nn, linewidth=3.0, label="energy_NN")
    plt.legend(loc="upper left")
    plt.savefig("energy_NN.png", dpi=300)


def plotSmallRange():
    energy_sim = np.array([0.00140393413458, 0.00140410370467, 0.00140437177351, 0.00140462507356, 0.00140477961625, 0.00140526447096, 0.0014054718487, 0.00140540065931, 0.00140551138116, 0.00140615070522, 0.0014062090845, 0.00140670281671, 0.0014067973581, 0.00140743948924, 0.00140741196852, 0.00140760259171, 0.0014079041797, 0.00140811515792, 0.00140846386017, 0.00140856017734, 0.00140903337452, 0.00140919635378, 0.00140931643405, 0.00140949773562, 0.00140974794601, 0.0014101574443, 0.00141031261072, 0.00141041405657, 0.00141114045915, 0.00141113491116, 0.00141149352042, 0.00141165372352, 0.00141170433742, 0.00141200308908, 0.00141250433215, 0.00141276752703, 0.00141293778239, 0.00141310590676, 0.00141350281411, 0.00141360802345, 0.00141386359833, 0.00141404916603, 0.00141427051509, 0.0014145274934, 0.00141472676178, 0.00141510632519, 0.00141523197909, 0.0014154751938, 0.00141589326035, 0.0014158367941, 0.00141615365941, 0.00141655661845, 0.00141667790251, 0.00141701960866, 0.00141706220563, 0.00141747004396, 0.00141782007214, 0.00141792564444, 0.00141807826926, 0.00141850166645, 0.00141867578708, 0.0014188907834, 0.0014191380241, 0.00141944322668, 0.00141983248403, 0.00141994970833, 0.00142006297779, 0.00142042798608, 0.00142075576328, 0.00142060825232, 0.00142116940979, 0.00142151956735, 0.00142173228477, 0.00142178050022, 0.00142205688287, 0.00142237586253, 0.00142248071203, 0.00142269647169, 0.00142289799087, 0.00142343351582, 0.00142352623824, 0.00142352617622, 0.00142396983801, 0.0014241585561, 0.00142435872971, 0.00142478497471, 0.00142481386882, 0.00142525085289, 0.00142552528744, 0.00142580430519, 0.0014258829014, 0.00142599809668, 0.00142633749614, 0.00142673475523, 0.00142700145135, 0.00142721934568, 0.00142744019189, 0.00142781789195, 0.00142790274267, 0.00142800382042])
    step = np.array([-0.005, -0.0049, -0.0048, -0.0047, -0.0046, -0.0045, -0.0044, -0.0043, -0.0042, -0.0041, -0.004, -0.0039, -0.0038, -0.0037, -0.0036, -0.0035, -0.0034, -0.0033, -0.0032, -0.0031, -0.003, -0.0029, -0.0028, -0.0027, -0.0026, -0.0025, -0.0024, -0.0023, -0.0022, -0.0021, -0.002, -0.0019, -0.0018, -0.0017, -0.0016, -0.0015, -0.0014, -0.0013, -0.0012, -0.0011, -0.001, -0.0009, -0.0008, -0.0007, -0.0006, -0.0005, -0.0004, -0.0003, -0.0002, -0.0001, -2.43945488809e-19, 0.0001, 0.0002, 0.0003, 0.0004, 0.0005, 0.0006, 0.0007, 0.0008, 0.0009, 0.001, 0.0011, 0.0012, 0.0013, 0.0014, 0.0015, 0.0016, 0.0017, 0.0018, 0.0019, 0.002, 0.0021, 0.0022, 0.0023, 0.0024, 0.0025, 0.0026, 0.0027, 0.0028, 0.0029, 0.003, 0.0031, 0.0032, 0.0033, 0.0034, 0.0035, 0.0036, 0.0037, 0.0038, 0.0039, 0.004, 0.0041, 0.0042, 0.0043, 0.0044, 0.0045, 0.0046, 0.0047, 0.0048, 0.0049])
    plt.plot(step, energy_sim, linewidth=3.0, label="energy_SIM")
    # plt.plot(step[:-1], energy_nn, linewidth=3.0, label="energy_NN")
    plt.legend(loc="upper left")
    plt.savefig("energy_sim_small.png", dpi=300)

def plotLargeRangeSim():
    energy_sim = np.array([0.00619191571356, 0.000699511082426, 0.000731052766228, 0.00076280562092, 0.00671704560453, 0.000776500948041, 0.000858120311304, 0.000889673290595, 0.000921391868277, 0.000952311369553, 0.000983006367828, 0.00101293882361, 0.00104316872217, 0.00107181143304, 0.00110041100624, 0.00112732949064, 0.00115410791259, 0.00117981686771, 0.00120478015479, 0.00122912215708, 0.00125242255248, 0.00127505386947, 0.00129622837442, 0.00131661661776, 0.00133609379423, 0.00135472821665, 0.00137162874856, 0.0013879888546, 0.00140344611078, 0.00141737864513, 0.00143017477465, 0.00144229404103, 0.00145238034099, 0.00146216095063, 0.00147030756672, 0.00147710819189, 0.00148269231935, 0.00148688278267, 0.00149011705978, 0.0014919410251, 0.00149231488324, 0.00149130852453, 0.00148874135948, 0.0014852923657, 0.00148014088229, 0.00147370407211, 0.00146559841911, 0.00145632167546, 0.00144562024671, 0.00143397542271, 0.00142027845965, 0.00140507105499, 0.00138876857413, 0.00137058394916, 0.00135136625659, 0.00133104783833, 0.00130896902292, 0.00128593946473, 0.00126185858824, 0.00123651430503, 0.00121005186387, 0.00118259503156, 0.00115437474634, 0.00112573160076, 0.00109631652209, 0.00106650293385, 0.00103641417845, 0.00100574873172, 0.000974930234723, 0.000944078469532, 0.00091324453013, 0.000882821478232, 0.000852334903602, 0.000822179640486, 0.000792431851443, 0.000763193153023, 0.000734396403062, 0.00070613895759, 0.000678430065304, 0.00065135008762, 0.0125189282955, 0.000599098753161, 0.000574088167843, 0.000549721317762, 0.00052608191981, 0.000503102973482, 0.000480846293272, 0.000459216796888, 0.000438352861944, 0.000418188542694, 0.000336398205648, 0.000379835708618, 0.000361576072493, 0.000344121919595, 0.00032721320703, 0.000310945766559, 0.000295286090949, 0.000280283261749, 0.000265919467752, 0.00025213553863])
    for i in range(len(energy_sim)):
        if energy_sim[i] > 0.002:
            energy_sim[i] = energy_sim[i+1]
    step = np.array([-0.25, -0.245, -0.24, -0.235, -0.23, -0.225, -0.22, -0.215, -0.21, -0.205, -0.2, -0.195, -0.19, -0.185, -0.18, -0.175, -0.17, -0.165, -0.16, -0.155, -0.15, -0.145, -0.14, -0.135, -0.13, -0.125, -0.12, -0.115, -0.11, -0.105, -0.1, -0.095, -0.09, -0.085, -0.08, -0.075, -0.07, -0.065, -0.06, -0.055, -0.05, -0.045, -0.04, -0.035, -0.03, -0.025, -0.02, -0.015, -0.01, -0.005, 1.54390389362e-16, 0.005, 0.01, 0.015, 0.02, 0.025, 0.03, 0.035, 0.04, 0.045, 0.05, 0.055, 0.06, 0.065, 0.07, 0.075, 0.08, 0.085, 0.09, 0.095, 0.1, 0.105, 0.11, 0.115, 0.12, 0.125, 0.13, 0.135, 0.14, 0.145, 0.15, 0.155, 0.16, 0.165, 0.17, 0.175, 0.18, 0.185, 0.19, 0.195, 0.2, 0.205, 0.21, 0.215, 0.22, 0.225, 0.23, 0.235, 0.24, 0.245])
    plt.plot(step, energy_sim, linewidth=3.0, label="energy_SIM")
    # plt.plot(step[:-1], energy_nn, linewidth=3.0, label="energy_NN")
    plt.legend(loc="upper left")
    plt.savefig("energy_sim_large.png", dpi=300)

def plotLargeRange():
    energy_sim = np.array([0.00022078601175, 0.000226168188196, -1, 0.000237410105027, 0.000243248145189, 0.000249241514875, 0.000254974831879, 0.00026097283746, -1, 0.000273414948369, 0.000279558626288, 0.000285593017799, -1, 0.000298467759757, 0.000305057546821, -1, 0.00031823267519, 0.000324937881357, 0.000332486231471, -1, 0.000346358504537, 0.000353058153926, 0.000360137468457, 0.000367265157041, 0.000374258763127, -1, 0.000388542900186, -1, 0.000403308836872, 0.000410892893718, 0.000418153414251, 0.000425734059505, 0.000433321558757, 0.000440688641368, 0.000448564033005, 0.017671782129, 0.000463055377736, -1, 0.000478984014163, 0.000487087917464, 0.000495003489305, 0.000503013952564, -1, 0.000519123541468, 0.000527158495806, 0.000535523005424, 0.000543085186387, 0.000551286110875, 0.000559890908326, 0.000569089915116, 0.000577055908508, 0.00058577083098, -1, 0.000602770587978, -1, 0.000619607641263, 0.000628254226116, 0.00063675150961, 0.000645406993033, 0.000653838086743, -1, 0.000670969257212, 0.000679815221443, 0.000688385914247, -1, 0.000705539678497, 0.000714473914862, 0.000722910772902, 0.00073198329691, 0.00074138363697, 0.000750043592126, 0.000759063911822, 0.00076810202042, 0.000776944728666, -1, 0.000794950209431, 0.000803596267288, -1, 0.000821706512227, 0.000830725219984, 0.000839613365805, -1, 0.000857542585025, 0.000866256603553, -1, 0.000885011495175, 0.000893380779281, 0.000902386159631, 0.000911581122075, 0.00092101198397, 0.000929866225146, 0.00093939451711, 0.00094780896825, 0.000956839326532, -1, 0.000975189398378, 0.000984100063699, 0.000993318456231, -1, 0.00101086763329, 0.00102091372634, 0.00102978377057, 0.00103872399685, 0.0010478639015, -1, 0.00106566354697, -1, 0.00108448274002, 0.00109368866468, 0.00110242199138, 0.00111162226227, 0.00112058842145, 0.00112918946506, 0.00113859231021, 0.00114691532417, 0.00115583862936, 0.0011648683934, 0.00117350558068, 0.00118272870304, 0.00119146527637, 0.00119988712023, -1, 0.00121776669743, 0.00122673837155, 0.00123535204379, 0.00124415269673, 0.00125301697154, 0.00126125800825, 0.00127002795613, 0.00127904494261, 0.00128757786639, 0.00129565744248, 0.00130383641431, -1, 0.00132225779624, 0.00133089220199, 0.00133920863796, 0.00134753197961, 0.00135569338456, 0.00136402724997, 0.00137232555576, 0.0013806511598, 0.00138900607751, -1, 0.00140537698186, 0.00141356467886, -1, 0.00142995411464, 0.00143812547161, 0.00144591222988, -1, 0.00146209705445, 0.00147005847891, 0.00147840090423, 0.00148617838426, 0.00149378101903, -1, 0.00150983626898, 0.00151727443822, 0.0015249677832, -1, 0.00154043727087, 0.00154774183241, -1, 0.00156279186435, 0.00157027163232, 0.00157738698954, 0.00158524064236, 0.00159149267213, 0.00160019392057, 0.00160691350242, 0.0016147463286, 0.00162135041917, -1, 0.00163609757756, 0.00164302367697, 0.00164995430567, 0.00165707721409, 0.00166412343908, 0.00167126325917, 0.00167789874023, 0.00168505514209, 0.00169174402728, 0.00169872299525, 0.00170454515972, -1, 0.00171810063633, 0.00172523599372, 0.00173202057995, 0.00173839979849, -1, 0.00175162729317, 0.00175788080753, 0.00176437260483, 0.00177048581598, 0.00177698347485, 0.00178390766489, 0.00178987559231, 0.00179628446242, 0.0018023876704])
    
    eneryg_sim_filtered = energy_sim
    # for i in range(len(energy_sim)):
    #     energy = energy_sim[i]
    #     if energy == -1 or energy > 0.0025:
    #         eneryg_sim_filtered[i] = 0.5 * (energy_sim[i-1] + energy_sim[i+1])


    step = np.array([-0.0338603077307, -0.0335217046534, -0.0331831015761, -0.0328444984988, -0.0325058954215, -0.0321672923442, -0.0318286892669, -0.0314900861896, -0.0311514831123, -0.030812880035, -0.0304742769577, -0.0301356738804, -0.0297970708031, -0.0294584677257, -0.0291198646484, -0.0287812615711, -0.0284426584938, -0.0281040554165, -0.0277654523392, -0.0274268492619, -0.0270882461846, -0.0267496431073, -0.02641104003, -0.0260724369527, -0.0257338338754, -0.0253952307981, -0.0250566277207, -0.0247180246434, -0.0243794215661, -0.0240408184888, -0.0237022154115, -0.0233636123342, -0.0230250092569, -0.0226864061796, -0.0223478031023, -0.022009200025, -0.0216705969477, -0.0213319938704, -0.0209933907931, -0.0206547877158, -0.0203161846384, -0.0199775815611, -0.0196389784838, -0.0193003754065, -0.0189617723292, -0.0186231692519, -0.0182845661746, -0.0179459630973, -0.01760736002, -0.0172687569427, -0.0169301538654, -0.0165915507881, -0.0162529477108, -0.0159143446334, -0.0155757415561, -0.0152371384788, -0.0148985354015, -0.0145599323242, -0.0142213292469, -0.0138827261696, -0.0135441230923, -0.013205520015, -0.0128669169377, -0.0125283138604, -0.0121897107831, -0.0118511077058, -0.0115125046285, -0.0111739015511, -0.0108352984738, -0.0104966953965, -0.0101580923192, -0.00981948924192, -0.00948088616461, -0.0091422830873, -0.00880368000999, -0.00846507693269, -0.00812647385538, -0.00778787077807, -0.00744926770076, -0.00711066462346, -0.00677206154615, -0.00643345846884, -0.00609485539153, -0.00575625231423, -0.00541764923692, -0.00507904615961, -0.0047404430823, -0.004401840005, -0.00406323692769, -0.00372463385038, -0.00338603077307, -0.00304742769577, -0.00270882461846, -0.00237022154115, -0.00203161846384, -0.00169301538654, -0.00135441230923, -0.00101580923192, -0.000677206154615, -0.000338603077307, 2.54924094944e-17, 0.000338603077307, 0.000677206154615, 0.00101580923192, 0.00135441230923, 0.00169301538654, 0.00203161846384, 0.00237022154115, 0.00270882461846, 0.00304742769577, 0.00338603077307, 0.00372463385038, 0.00406323692769, 0.004401840005, 0.0047404430823, 0.00507904615961, 0.00541764923692, 0.00575625231423, 0.00609485539153, 0.00643345846884, 0.00677206154615, 0.00711066462346, 0.00744926770076, 0.00778787077807, 0.00812647385538, 0.00846507693269, 0.00880368000999, 0.0091422830873, 0.00948088616461, 0.00981948924192, 0.0101580923192, 0.0104966953965, 0.0108352984738, 0.0111739015511, 0.0115125046285, 0.0118511077058, 0.0121897107831, 0.0125283138604, 0.0128669169377, 0.013205520015, 0.0135441230923, 0.0138827261696, 0.0142213292469, 0.0145599323242, 0.0148985354015, 0.0152371384788, 0.0155757415561, 0.0159143446334, 0.0162529477108, 0.0165915507881, 0.0169301538654, 0.0172687569427, 0.01760736002, 0.0179459630973, 0.0182845661746, 0.0186231692519, 0.0189617723292, 0.0193003754065, 0.0196389784838, 0.0199775815611, 0.0203161846384, 0.0206547877158, 0.0209933907931, 0.0213319938704, 0.0216705969477, 0.022009200025, 0.0223478031023, 0.0226864061796, 0.0230250092569, 0.0233636123342, 0.0237022154115, 0.0240408184888, 0.0243794215661, 0.0247180246434, 0.0250566277207, 0.0253952307981, 0.0257338338754, 0.0260724369527, 0.02641104003, 0.0267496431073, 0.0270882461846, 0.0274268492619, 0.0277654523392, 0.0281040554165, 0.0284426584938, 0.0287812615711, 0.0291198646484, 0.0294584677257, 0.0297970708031, 0.0301356738804, 0.0304742769577, 0.030812880035, 0.0311514831123, 0.0314900861896, 0.0318286892669, 0.0321672923442, 0.0325058954215, 0.0328444984988, 0.0331831015761, 0.0335217046534])
    plt.plot(step, eneryg_sim_filtered, linewidth=3.0, label="energy_SIM")
    # plt.plot(step[:-1], energy_nn, linewidth=3.0, label="energy_NN")
    plt.legend(loc="upper left")
    plt.savefig("energy_sim_large.png", dpi=300)
plotOpt()
# def plotStressStrain():
#     stress_targets = [-0.0062526,  0.0239273,  0.0717616]
#     strain_points = [-0.025, 0.025, 0.085]
#     stress_init = [-0.00679526,  -0.00502051,   -0.0030519, -0.000819364,   0.00177995,   0.00489931,    0.0087674,    0.0137137,    0.0201606,    0.0285033]
#     strain_samples = [-0.05, -0.035, -0.02, -0.005, 0.01, 0.025, 0.04, 0.055, 0.07, 0.085]
#     stress_opt = [-0.0173978,  -0.0145991, -0.00944198, -0.00263387,  0.00583585,   0.0160394,    0.027973,   0.0415263,   0.0564564,   0.0723998]
#     stress_opt_LBFGS = [-0.0166228, -0.0135108, -0.00871856, -0.00245242, 0.00551745, 0.0154674, 0.0275296, 0.0415726, 0.0571899, 0.0738213]
#     plt.plot(strain_samples, stress_init, label="stress initial")
#     plt.plot(strain_samples, stress_opt_LBFGS, label = "stress optimized")
#     plt.scatter(strain_points, stress_targets, s=4.0)
#     plt.legend(loc="upper left")
#     plt.xlabel("strain")
#     plt.ylabel("stress")
#     plt.savefig("uniaxial_stress_FD_LBFGS.png", dpi=300)
#     plt.close()

# plotStressStrain()