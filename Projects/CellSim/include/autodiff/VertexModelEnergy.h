#ifndef VERTEX_MODEL_ENERGY_H
#define VERTEX_MODEL_ENERGY_H

#include "../VecMatDef.h"
#include <iostream>




void computeTetVolume(const Matrix<double,3,1> & a, const Matrix<double,3,1> & b, const Matrix<double,3,1> & c, const Matrix<double,3,1> & d, double& energy){
	double _i_var[25];
	_i_var[0] = (c(2,0))-(d(2,0));
	_i_var[1] = (b(0,0))-(d(0,0));
	_i_var[2] = (c(0,0))-(d(0,0));
	_i_var[3] = (b(2,0))-(d(2,0));
	_i_var[4] = (c(1,0))-(d(1,0));
	_i_var[5] = (b(1,0))-(d(1,0));
	_i_var[6] = (_i_var[1])*(_i_var[0]);
	_i_var[7] = (_i_var[3])*(_i_var[2]);
	_i_var[8] = (_i_var[3])*(_i_var[4]);
	_i_var[9] = (_i_var[5])*(_i_var[0]);
	_i_var[10] = (_i_var[5])*(_i_var[2]);
	_i_var[11] = (_i_var[1])*(_i_var[4]);
	_i_var[12] = (a(1,0))-(d(1,0));
	_i_var[13] = (_i_var[7])-(_i_var[6]);
	_i_var[14] = (a(0,0))-(d(0,0));
	_i_var[15] = (_i_var[9])-(_i_var[8]);
	_i_var[16] = (a(2,0))-(d(2,0));
	_i_var[17] = (_i_var[11])-(_i_var[10]);
	_i_var[18] = (_i_var[13])*(_i_var[12]);
	_i_var[19] = (_i_var[15])*(_i_var[14]);
	_i_var[20] = (_i_var[17])*(_i_var[16]);
	_i_var[21] = (_i_var[19])+(_i_var[18]);
	_i_var[22] = (_i_var[21])+(_i_var[20]);
	_i_var[23] = 0.16666666666666666;
	_i_var[24] = (_i_var[23])*(_i_var[22]);
	energy = _i_var[24];
}
void computeTetVolumeGradient(const Matrix<double,3,1> & a, const Matrix<double,3,1> & b, const Matrix<double,3,1> & c, const Matrix<double,3,1> & d, Matrix<double, 12, 1>& energygradient){
	double _i_var[62];
	_i_var[0] = (a(2,0))-(d(2,0));
	_i_var[1] = 0.16666666666666666;
	_i_var[2] = (a(0,0))-(d(0,0));
	_i_var[3] = (a(1,0))-(d(1,0));
	_i_var[4] = -1;
	_i_var[5] = (_i_var[1])*(_i_var[0]);
	_i_var[6] = (c(1,0))-(d(1,0));
	_i_var[7] = (b(2,0))-(d(2,0));
	_i_var[8] = (c(2,0))-(d(2,0));
	_i_var[9] = (b(1,0))-(d(1,0));
	_i_var[10] = (b(0,0))-(d(0,0));
	_i_var[11] = (c(0,0))-(d(0,0));
	_i_var[12] = (_i_var[1])*(_i_var[2]);
	_i_var[13] = (_i_var[1])*(_i_var[3]);
	_i_var[14] = (_i_var[5])*(_i_var[4]);
	_i_var[15] = (_i_var[7])*(_i_var[6]);
	_i_var[16] = (_i_var[9])*(_i_var[8]);
	_i_var[17] = (_i_var[10])*(_i_var[8]);
	_i_var[18] = (_i_var[7])*(_i_var[11]);
	_i_var[19] = (_i_var[12])*(_i_var[4]);
	_i_var[20] = (_i_var[9])*(_i_var[11]);
	_i_var[21] = (_i_var[10])*(_i_var[6]);
	_i_var[22] = (_i_var[13])*(_i_var[4]);
	_i_var[23] = (_i_var[13])*(_i_var[7]);
	_i_var[24] = (_i_var[14])*(_i_var[9]);
	_i_var[25] = (_i_var[16])-(_i_var[15]);
	_i_var[26] = (_i_var[12])*(_i_var[8]);
	_i_var[27] = (_i_var[14])*(_i_var[11]);
	_i_var[28] = (_i_var[18])-(_i_var[17]);
	_i_var[29] = (_i_var[13])*(_i_var[11]);
	_i_var[30] = (_i_var[19])*(_i_var[6]);
	_i_var[31] = (_i_var[21])-(_i_var[20]);
	_i_var[32] = (_i_var[22])*(_i_var[8]);
	_i_var[33] = (_i_var[5])*(_i_var[6]);
	_i_var[34] = (_i_var[24])+(_i_var[23]);
	_i_var[35] = (_i_var[1])*(_i_var[25]);
	_i_var[36] = (_i_var[19])*(_i_var[7]);
	_i_var[37] = (_i_var[5])*(_i_var[10]);
	_i_var[38] = (_i_var[27])+(_i_var[26]);
	_i_var[39] = (_i_var[1])*(_i_var[28]);
	_i_var[40] = (_i_var[22])*(_i_var[10]);
	_i_var[41] = (_i_var[12])*(_i_var[9]);
	_i_var[42] = (_i_var[30])+(_i_var[29]);
	_i_var[43] = (_i_var[1])*(_i_var[31]);
	_i_var[44] = (_i_var[33])+(_i_var[32]);
	_i_var[45] = (_i_var[34])*(_i_var[4]);
	_i_var[46] = (_i_var[35])*(_i_var[4]);
	_i_var[47] = (_i_var[37])+(_i_var[36]);
	_i_var[48] = (_i_var[38])*(_i_var[4]);
	_i_var[49] = (_i_var[39])*(_i_var[4]);
	_i_var[50] = (_i_var[41])+(_i_var[40]);
	_i_var[51] = (_i_var[42])*(_i_var[4]);
	_i_var[52] = (_i_var[43])*(_i_var[4]);
	_i_var[53] = (_i_var[44])*(_i_var[4]);
	_i_var[54] = (_i_var[46])+(_i_var[45]);
	_i_var[55] = (_i_var[47])*(_i_var[4]);
	_i_var[56] = (_i_var[49])+(_i_var[48]);
	_i_var[57] = (_i_var[50])*(_i_var[4]);
	_i_var[58] = (_i_var[52])+(_i_var[51]);
	_i_var[59] = (_i_var[54])+(_i_var[53]);
	_i_var[60] = (_i_var[56])+(_i_var[55]);
	_i_var[61] = (_i_var[58])+(_i_var[57]);
	energygradient(0,0) = _i_var[35];
	energygradient(1,0) = _i_var[39];
	energygradient(2,0) = _i_var[43];
	energygradient(3,0) = _i_var[44];
	energygradient(4,0) = _i_var[38];
	energygradient(5,0) = _i_var[42];
	energygradient(6,0) = _i_var[34];
	energygradient(7,0) = _i_var[47];
	energygradient(8,0) = _i_var[50];
	energygradient(9,0) = _i_var[59];
	energygradient(10,0) = _i_var[60];
	energygradient(11,0) = _i_var[61];
}
void computeTetVolumeHessian(const Matrix<double,3,1> & a, const Matrix<double,3,1> & b, const Matrix<double,3,1> & c, const Matrix<double,3,1> & d, Matrix<double, 12, 12>& energyhessian){
	double _i_var[81];
	_i_var[0] = (a(2,0))-(d(2,0));
	_i_var[1] = 0.16666666666666666;
	_i_var[2] = (a(1,0))-(d(1,0));
	_i_var[3] = (a(0,0))-(d(0,0));
	_i_var[4] = -1;
	_i_var[5] = (_i_var[1])*(_i_var[0]);
	_i_var[6] = (_i_var[1])*(_i_var[2]);
	_i_var[7] = (b(1,0))-(d(1,0));
	_i_var[8] = (_i_var[1])*(_i_var[3]);
	_i_var[9] = (_i_var[5])*(_i_var[4]);
	_i_var[10] = -0.16666666666666666;
	_i_var[11] = (b(2,0))-(d(2,0));
	_i_var[12] = (c(2,0))-(d(2,0));
	_i_var[13] = (_i_var[4])*(_i_var[6]);
	_i_var[14] = (_i_var[7])*(_i_var[1]);
	_i_var[15] = (c(1,0))-(d(1,0));
	_i_var[16] = (_i_var[8])*(_i_var[4]);
	_i_var[17] = (c(0,0))-(d(0,0));
	_i_var[18] = (b(0,0))-(d(0,0));
	_i_var[19] = (_i_var[4])*(_i_var[9]);
	_i_var[20] = (_i_var[11])*(_i_var[10]);
	_i_var[21] = (_i_var[11])*(_i_var[1]);
	_i_var[22] = (_i_var[12])*(_i_var[10]);
	_i_var[23] = (_i_var[6])*(_i_var[4]);
	_i_var[24] = (_i_var[14])+(_i_var[13]);
	_i_var[25] = (_i_var[15])*(_i_var[1]);
	_i_var[26] = (_i_var[4])*(_i_var[16]);
	_i_var[27] = (_i_var[17])*(_i_var[10]);
	_i_var[28] = (_i_var[18])*(_i_var[10]);
	_i_var[29] = (_i_var[17])*(_i_var[1]);
	_i_var[30] = (_i_var[4])*(_i_var[5]);
	_i_var[31] = (_i_var[12])*(_i_var[1]);
	_i_var[32] = (_i_var[20])+(_i_var[19]);
	_i_var[33] = (_i_var[4])*(_i_var[21]);
	_i_var[34] = (_i_var[4])*(_i_var[22]);
	_i_var[35] = (_i_var[4])*(_i_var[23]);
	_i_var[36] = (_i_var[7])*(_i_var[10]);
	_i_var[37] = (_i_var[15])*(_i_var[10]);
	_i_var[38] = (_i_var[4])*(_i_var[24]);
	_i_var[39] = (_i_var[4])*(_i_var[25]);
	_i_var[40] = (_i_var[4])*(_i_var[8]);
	_i_var[41] = (_i_var[18])*(_i_var[1]);
	_i_var[42] = (_i_var[27])+(_i_var[26]);
	_i_var[43] = (_i_var[4])*(_i_var[28]);
	_i_var[44] = (_i_var[4])*(_i_var[29]);
	_i_var[45] = (_i_var[31])+(_i_var[30]);
	_i_var[46] = (_i_var[4])*(_i_var[32]);
	_i_var[47] = (_i_var[34])+(_i_var[33]);
	_i_var[48] = (_i_var[36])+(_i_var[35]);
	_i_var[49] = (_i_var[4])*(_i_var[37]);
	_i_var[50] = (_i_var[39])+(_i_var[38]);
	_i_var[51] = (_i_var[41])+(_i_var[40]);
	_i_var[52] = (_i_var[4])*(_i_var[42]);
	_i_var[53] = (_i_var[44])+(_i_var[43]);
	_i_var[54] = (_i_var[4])*(_i_var[20]);
	_i_var[55] = (_i_var[4])*(_i_var[31]);
	_i_var[56] = (_i_var[4])*(_i_var[14]);
	_i_var[57] = (_i_var[4])*(_i_var[36]);
	_i_var[58] = (_i_var[4])*(_i_var[41]);
	_i_var[59] = (_i_var[4])*(_i_var[27]);
	_i_var[60] = (_i_var[4])*(_i_var[45]);
	_i_var[61] = (_i_var[47])+(_i_var[46]);
	_i_var[62] = (_i_var[4])*(_i_var[48]);
	_i_var[63] = (_i_var[50])+(_i_var[49]);
	_i_var[64] = (_i_var[4])*(_i_var[51]);
	_i_var[65] = (_i_var[53])+(_i_var[52]);
	_i_var[66] = 0;
	_i_var[67] = (_i_var[55])+(_i_var[54]);
	_i_var[68] = (_i_var[49])+(_i_var[56]);
	_i_var[69] = (_i_var[33])+(_i_var[34]);
	_i_var[70] = (_i_var[57])+(_i_var[39]);
	_i_var[71] = (_i_var[59])+(_i_var[58]);
	_i_var[72] = (_i_var[37])+(_i_var[35]);
	_i_var[73] = (_i_var[22])+(_i_var[19]);
	_i_var[74] = (_i_var[29])+(_i_var[40]);
	_i_var[75] = (_i_var[25])+(_i_var[13]);
	_i_var[76] = (_i_var[21])+(_i_var[30]);
	_i_var[77] = (_i_var[28])+(_i_var[26]);
	_i_var[78] = (_i_var[61])+(_i_var[60]);
	_i_var[79] = (_i_var[63])+(_i_var[62]);
	_i_var[80] = (_i_var[65])+(_i_var[64]);
	energyhessian(0,0) = _i_var[66];
	energyhessian(1,0) = _i_var[66];
	energyhessian(2,0) = _i_var[66];
	energyhessian(3,0) = _i_var[66];
	energyhessian(4,0) = _i_var[31];
	energyhessian(5,0) = _i_var[37];
	energyhessian(6,0) = _i_var[66];
	energyhessian(7,0) = _i_var[20];
	energyhessian(8,0) = _i_var[14];
	energyhessian(9,0) = _i_var[66];
	energyhessian(10,0) = _i_var[67];
	energyhessian(11,0) = _i_var[68];
	energyhessian(0,1) = _i_var[66];
	energyhessian(1,1) = _i_var[66];
	energyhessian(2,1) = _i_var[66];
	energyhessian(3,1) = _i_var[22];
	energyhessian(4,1) = _i_var[66];
	energyhessian(5,1) = _i_var[29];
	energyhessian(6,1) = _i_var[21];
	energyhessian(7,1) = _i_var[66];
	energyhessian(8,1) = _i_var[28];
	energyhessian(9,1) = _i_var[69];
	energyhessian(10,1) = _i_var[66];
	energyhessian(11,1) = _i_var[53];
	energyhessian(0,2) = _i_var[66];
	energyhessian(1,2) = _i_var[66];
	energyhessian(2,2) = _i_var[66];
	energyhessian(3,2) = _i_var[25];
	energyhessian(4,2) = _i_var[27];
	energyhessian(5,2) = _i_var[66];
	energyhessian(6,2) = _i_var[36];
	energyhessian(7,2) = _i_var[41];
	energyhessian(8,2) = _i_var[66];
	energyhessian(9,2) = _i_var[70];
	energyhessian(10,2) = _i_var[71];
	energyhessian(11,2) = _i_var[66];
	energyhessian(0,3) = _i_var[66];
	energyhessian(1,3) = _i_var[22];
	energyhessian(2,3) = _i_var[25];
	energyhessian(3,3) = _i_var[66];
	energyhessian(4,3) = _i_var[66];
	energyhessian(5,3) = _i_var[66];
	energyhessian(6,3) = _i_var[66];
	energyhessian(7,3) = _i_var[5];
	energyhessian(8,3) = _i_var[23];
	energyhessian(9,3) = _i_var[66];
	energyhessian(10,3) = _i_var[45];
	energyhessian(11,3) = _i_var[72];
	energyhessian(0,4) = _i_var[31];
	energyhessian(1,4) = _i_var[66];
	energyhessian(2,4) = _i_var[27];
	energyhessian(3,4) = _i_var[66];
	energyhessian(4,4) = _i_var[66];
	energyhessian(5,4) = _i_var[66];
	energyhessian(6,4) = _i_var[9];
	energyhessian(7,4) = _i_var[66];
	energyhessian(8,4) = _i_var[8];
	energyhessian(9,4) = _i_var[73];
	energyhessian(10,4) = _i_var[66];
	energyhessian(11,4) = _i_var[74];
	energyhessian(0,5) = _i_var[37];
	energyhessian(1,5) = _i_var[29];
	energyhessian(2,5) = _i_var[66];
	energyhessian(3,5) = _i_var[66];
	energyhessian(4,5) = _i_var[66];
	energyhessian(5,5) = _i_var[66];
	energyhessian(6,5) = _i_var[6];
	energyhessian(7,5) = _i_var[16];
	energyhessian(8,5) = _i_var[66];
	energyhessian(9,5) = _i_var[75];
	energyhessian(10,5) = _i_var[42];
	energyhessian(11,5) = _i_var[66];
	energyhessian(0,6) = _i_var[66];
	energyhessian(1,6) = _i_var[21];
	energyhessian(2,6) = _i_var[36];
	energyhessian(3,6) = _i_var[66];
	energyhessian(4,6) = _i_var[9];
	energyhessian(5,6) = _i_var[6];
	energyhessian(6,6) = _i_var[66];
	energyhessian(7,6) = _i_var[66];
	energyhessian(8,6) = _i_var[66];
	energyhessian(9,6) = _i_var[66];
	energyhessian(10,6) = _i_var[32];
	energyhessian(11,6) = _i_var[24];
	energyhessian(0,7) = _i_var[20];
	energyhessian(1,7) = _i_var[66];
	energyhessian(2,7) = _i_var[41];
	energyhessian(3,7) = _i_var[5];
	energyhessian(4,7) = _i_var[66];
	energyhessian(5,7) = _i_var[16];
	energyhessian(6,7) = _i_var[66];
	energyhessian(7,7) = _i_var[66];
	energyhessian(8,7) = _i_var[66];
	energyhessian(9,7) = _i_var[76];
	energyhessian(10,7) = _i_var[66];
	energyhessian(11,7) = _i_var[77];
	energyhessian(0,8) = _i_var[14];
	energyhessian(1,8) = _i_var[28];
	energyhessian(2,8) = _i_var[66];
	energyhessian(3,8) = _i_var[23];
	energyhessian(4,8) = _i_var[8];
	energyhessian(5,8) = _i_var[66];
	energyhessian(6,8) = _i_var[66];
	energyhessian(7,8) = _i_var[66];
	energyhessian(8,8) = _i_var[66];
	energyhessian(9,8) = _i_var[48];
	energyhessian(10,8) = _i_var[51];
	energyhessian(11,8) = _i_var[66];
	energyhessian(0,9) = _i_var[66];
	energyhessian(1,9) = _i_var[69];
	energyhessian(2,9) = _i_var[70];
	energyhessian(3,9) = _i_var[66];
	energyhessian(4,9) = _i_var[73];
	energyhessian(5,9) = _i_var[75];
	energyhessian(6,9) = _i_var[66];
	energyhessian(7,9) = _i_var[76];
	energyhessian(8,9) = _i_var[48];
	energyhessian(9,9) = _i_var[66];
	energyhessian(10,9) = _i_var[78];
	energyhessian(11,9) = _i_var[79];
	energyhessian(0,10) = _i_var[67];
	energyhessian(1,10) = _i_var[66];
	energyhessian(2,10) = _i_var[71];
	energyhessian(3,10) = _i_var[45];
	energyhessian(4,10) = _i_var[66];
	energyhessian(5,10) = _i_var[42];
	energyhessian(6,10) = _i_var[32];
	energyhessian(7,10) = _i_var[66];
	energyhessian(8,10) = _i_var[51];
	energyhessian(9,10) = _i_var[78];
	energyhessian(10,10) = _i_var[66];
	energyhessian(11,10) = _i_var[80];
	energyhessian(0,11) = _i_var[68];
	energyhessian(1,11) = _i_var[53];
	energyhessian(2,11) = _i_var[66];
	energyhessian(3,11) = _i_var[72];
	energyhessian(4,11) = _i_var[74];
	energyhessian(5,11) = _i_var[66];
	energyhessian(6,11) = _i_var[24];
	energyhessian(7,11) = _i_var[77];
	energyhessian(8,11) = _i_var[66];
	energyhessian(9,11) = _i_var[79];
	energyhessian(10,11) = _i_var[80];
	energyhessian(11,11) = _i_var[66];
}




#endif
